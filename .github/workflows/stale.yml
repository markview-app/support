name: Close Stale Issues
on:
  schedule:
    # Run weekly on Mondays at 00:00 UTC
    - cron: '0 0 * * 1'
  workflow_dispatch: # Allow manual trigger

permissions:
  issues: write

jobs:
  # Handle questions separately (shorter stale period)
  stale-questions:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v9
        with:
          # Only process questions
          only-issue-labels: 'question'

          # Questions become stale faster (often already answered)
          days-before-stale: 60
          days-before-close: 14

          stale-issue-label: 'stale'

          stale-issue-message: |
            This question has been inactive for 60 days and will be automatically closed in 14 days if no further activity occurs.

            If you still need help, please add a comment to keep this open. Thank you! üôè

          close-issue-message: |
            This question was automatically closed due to inactivity. If you still need help, feel free to reopen or create a new issue. Thank you! üôè

          operations-per-run: 30

  # Handle all other issues (longer stale period)
  stale-issues:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v9
        with:
          # Don't mark these important labels as stale
          exempt-issue-labels: 'bug,critical,in-progress,confirmed,enhancement,needs-review,needs-info,needs-triage,question'

          # More generous timeline for bugs/features
          days-before-stale: 90
          days-before-close: 30

          stale-issue-label: 'stale'

          stale-issue-message: |
            This issue has been inactive for 90 days and will be automatically closed in 30 days if no further activity occurs.

            If this is still relevant, please add a comment to keep it open. Thank you! üôè

          close-issue-message: |
            This issue was automatically closed due to inactivity. If you believe this is still relevant, feel free to reopen or create a new issue. Thank you! üôè

          operations-per-run: 30
