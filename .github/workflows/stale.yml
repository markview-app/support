name: Close Stale Issues
on:
  schedule:
    # Run weekly on Mondays at 00:00 UTC (less aggressive than daily)
    - cron: '0 0 * * 1'
  workflow_dispatch: # Allow manual trigger

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v9
        with:
          # Days before marking as stale (more generous for support repo)
          days-before-stale: 90
          days-before-issue-stale: 90

          # Days before closing after marked stale
          days-before-close: 30
          days-before-issue-close: 30

          # Label to use for stale issues
          stale-issue-label: 'stale'

          # Message when marking as stale
          stale-issue-message: |
            This issue has been inactive for 90 days and will be automatically closed in 30 days if no further activity occurs.

            If this is still relevant, please add a comment to keep it open. Thank you! üôè

          # Message when closing
          close-issue-message: |
            This issue was automatically closed due to inactivity. If you believe this is still relevant, feel free to reopen or create a new issue. Thank you! üôè

          # Don't mark issues with these labels as stale
          exempt-issue-labels: 'bug,critical,in-progress,confirmed,enhancement,needs-review,needs-info'

          # Questions can close faster (already answered or no longer relevant)
          exempt-issue-labels: ''
          only-issue-labels: 'question'
          days-before-stale: 60
          days-before-close: 14

          # Don't mark PRs as stale (no PRs in support repo anyway)
          exempt-all-pr-milestones: true
          exempt-all-pr-assignees: true

          # Lighter operations for weekly runs
          operations-per-run: 60
